{% extends 'base.html.twig' %}

{% block title %}Une petite faim ?{% endblock %}

{% block body %}

{#    {{ dump(franchiseStockData) }}#}

    <div class="container mt-3">
        <div class="jumbotron">
            <h1 class="display-4">{% trans %}Stockage{% endtrans %}</h1>
            <p class="lead">{% trans %}C'est ici que vous pouvez consulter votre stock acutel{% endtrans %}</p>
            <hr class="my-4">
            <p>{% trans %}Vous avez besoin d'un ou plusieurs produits pour réaliser l'un des éléments de votre menu{% endtrans %}</p>
            <p>{% trans %}Si l'un des produits nécessaire à la réalistion d'un menu venait à manquer, alors vous devrez passer par une autre commande,
                sans quoi, vous ne pourrez vendre le menu en question.{% endtrans %}</p>
        </div>
    </div>

    <div class="container">
        <a href="{{ path('franchise_menu', {"id" : id}) }}" class="btn btn-outline-dark">Retour à Ma Franchise</a>
    </div>


    {% if franchiseStockData is not empty %}
        <div class="container mt-4">

            <h5 class="display-5">Stockage</h5>

            <div class="card">
                <div class="card-body">
                    <p class="lead">Etat actuel du camion</p>
                    <p class="">Espace occupé : {{ franchiseStockData.nb_products }}</p>
                    <p class="">Espace maximum occupabe : {{ franchiseStockData.nb_max_products }}</p>
                    <p class="">Espace restant : {{ franchiseStockData.nb_max_products - franchiseStockData.nb_products }}</p>
                </div>
            </div>
            {% set proportion = (franchiseStockData.nb_products * 100) / franchiseStockData.nb_max_products %}

            <h5 class="display-5 mt-3">Occupation en %</h5>
            <div class="progress mt-3">
                <div class="progress-bar" role="progressbar" style="width: {{ proportion | round(2, 'floor') }}%;" aria-valuenow="25" aria-valuemin="0"
                     aria-valuemax="{{ franchiseStockData.nb_max_products }}">{{ proportion | round(2, 'floor') }}%
                </div>
            </div>
            <div class="lead">{{ proportion | round(2, 'floor') }}%</div>


        </div>

        <div class="container mt-5">
            <ul class="list-group">
                <li class="list-group-item d-flex justify-content-between align-items-center">
                    CONTENU DE L'ENTREPÔT
                </li>
                <li class="list-group-item d-flex justify-content-between align-items-center">
                    Nombre total d'ingrédients dans le camion
                    <span class="badge badge-dark badge-pill">{{ franchiseStockData.nb_ingredients }}</span>
                    <span class="badge badge-secondary">{{ franchiseStockData.nb_max_ingredients }}</span>
                </li>
                <li class="list-group-item d-flex justify-content-between align-items-center">
                    Nombre total de boissons dans le camion
                    <span class="badge badge-info badge-pill">{{ franchiseStockData.nb_drinks }}</span>
                    <span class="badge badge-secondary">{{ franchiseStockData.nb_max_drinks }}</span>
                </li>
                <li class="list-group-item d-flex justify-content-between align-items-center">
                    Nombre total de desserts dans le camion
                    <span class="badge badge-light badge-pill">{{ franchiseStockData.nb_desserts }}</span>
                    <span class="badge badge-secondary">{{ franchiseStockData.nb_max_desserts }}</span>
                </li>
                <li class="list-group-item d-flex justify-content-between align-items-center">
                    Nombre total de repas actuels dans le camion
                    <span class="badge badge-warning badge-pill">{{ franchiseStockData.nb_meals }}</span>
                    <span class="badge badge-secondary">{{ franchiseStockData.nb_max_meals }}</span>
                </li>
            </ul>
        </div>
    {% endif %}


    <div class="container-fluid">

        {% if stock is empty %}
            <div class="container mt-5">
                <div class="alert alert-warning" role="alert">
                    Vous ne possédez rien en stock
                </div>
            </div>

        {% else %}

            <table class="table table-striped mt-5">
                <thead>
                <tr>
                    <th scope="col">Id</th>
                    <th scope="col">Produit</th>
                    <th scope="col">Quantité</th>
                    <th scope="col">Categorie</th>
                </tr>
                </thead>
                <tbody>
                {% for item in stock %}
                    <tr>
                        <th scope="row">{{ item.id }}</th>
                        <td>{{ item.product.name }}</td>
                        <td>{{ item.quantity }} {{ item.product.type }}</td>
                        <td>
                            {% if item.product.subCategory.category.name == 'Ingrédients' %}
                                {% set badge = 'badge-dark' %}
                            {% elseif item.product.subCategory.category.name == 'Boissons' %}
                                {% set badge = 'badge-info' %}
                            {% elseif item.product.subCategory.category.name == 'Desserts' %}
                                {% set badge = 'badge-light' %}
                            {% elseif item.product.subCategory.category.name == 'Repas' %}
                                {% set badge = 'badge-warning' %}
                            {% endif %}
                            <span class="badge badge-pill {{ badge }}">{{ item.product.subCategory.category.name }}</span>
                        </td>
                    </tr>
                {% endfor %}
                </tbody>
            </table>

        {% endif %}


    </div>





{% endblock %}
